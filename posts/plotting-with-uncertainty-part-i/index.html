<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Using colors to help users see if a value is within a distribution's confidence interval.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Plotting With Uncertainty (Part I) | Data Science With Python</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/data_science/posts/plotting-with-uncertainty-part-i/">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
    },
    displayAlign: 'left', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script><meta name="author" content="necromuralist">
<link rel="prev" href="../assignment-2-olympic-medals/" title="Assignment 2 - Pandas Introduction (Olympic Medals)" type="text/html">
<meta property="og:site_name" content="Data Science With Python">
<meta property="og:title" content="Plotting With Uncertainty (Part I)">
<meta property="og:url" content="https://necromuralist.github.io/data_science/posts/plotting-with-uncertainty-part-i/">
<meta property="og:description" content="Using colors to help users see if a value is within a distribution's confidence interval.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-04-22T00:12:41-08:00">
<meta property="article:tag" content="python visualization coursera">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://necromuralist.github.io/data_science/">

                <span id="blog-title">Data Science With Python</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form
 navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/data_science/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Plotting With Uncertainty (Part I)</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    necromuralist
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2017-04-22T00:12:41-08:00" itemprop="datePublished" title="2017-04-22 00:12">2017-04-22 00:12</time></a></p>
            
        <p class="sourceline"><a href="index.org" id="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>
This is an implementation of the <i>easiest</i> option for Assignment 3 of coursera's <a href="https://www.coursera.org/learn/python-plotting/home/welcome">Applied Plotting, Charting &amp; Data Representation in Python</a>.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Description</h2>
<div class="outline-text-2" id="text-1">
<p>
In this <a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/Ferreira_Fisher_Sample_Oriented_Tasks.pdf">paper</a> the authors describe the challenges users face when trying to make
judgements about probabilistic data generated through samples. As an
example, they look at a bar chart of four years of data (replicated
below in Figure 1). Each year has a y-axis value, which is derived from
a sample of a larger dataset. For instance, the first value might be the
number votes in a given district or riding for 1992, with the average
being around 33,000. On top of this is plotted the confidence interval
– the range of the number of votes which encapsulates 95% of the data
(see the boxplot lectures for more information, and the yerr parameter
of barcharts).
</p>

<p>
A challenge that users face is that, for a given y-axis value (e.g.
42,000), it is difficult to know which x-axis values are most likely to
be representative, because the confidence levels overlap and their
distributions are different (the lengths of the confidence interval bars
are unequal). One of the solutions the authors propose for this problem
(Figure 2c) is to allow users to indicate the y-axis value of interest
(e.g. 42,000) and then draw a horizontal line and color bars based on
this value. So bars might be colored red if they are definitely above
this value (given the confidence interval), blue if they are definitely
below this value, or white if they contain this value.
</p>


<p>
  <b>Easiest option:</b> Implement the bar coloring as described above - a color scale with only three colors, (e.g. blue, white, and red). Assume the user provides the y axis value of interest as a parameter or
variable.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Imports</h2>
<div class="outline-text-2" id="text-2">
<p>
All the imports were created by third-parties (taken from pypi).
</p>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
</pre></div>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Some Plotting Setup</h3>
<div class="outline-text-3" id="text-2-1">
<div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">"whitegrid"</span><span class="p">)</span>
<span class="n">style</span><span class="p">[</span><span class="s2">"axes.grid"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">"whitegrid"</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">The Data</h2>
<div class="outline-text-2" id="text-3">
<p>
The data set will be four normally-distributed, randomly generated, data sets each representing a simulated data set for a given year.
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><code>numpy.random.normal</code></h3>
<div class="outline-text-3" id="text-3-1">
<p>
This is from the <code>numpy.random.normal</code> doc-string:
</p>

<p>
<code>normal(loc=0.0, scale=1.0, size=None)</code>
</p>

<p>
Draw random samples from a normal (Gaussian) distribution.
</p>

<p>
The probability density function of the normal distribution, first
derived by De Moivre and 200 years later by both Gauss and Laplace
independently<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>, is often called the bell curve because of
its characteristic shape (see the example below).
</p>

<p>
The normal distributions occurs often in nature.  For example, it
describes the commonly occurring distribution of samples influenced
by a large number of tiny, random disturbances, each with its own
unique distribution<sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup>.
</p>
</div>

<div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1">Parameters</h4>
<div class="outline-text-4" id="text-3-1-1">
</div>
<ul class="org-ul">
<li>
<a id="sec-3-1-1-1" name="sec-3-1-1-1"></a><code>loc</code> : float or array-like of floats<br><div class="outline-text-5" id="text-3-1-1-1">
<p>
Mean ("centre") of the distribution.
</p>
</div>
</li>
<li>
<a id="sec-3-1-1-2" name="sec-3-1-1-2"></a><code>scale</code> : float or array-like of floats<br><div class="outline-text-5" id="text-3-1-1-2">
<p>
Standard deviation (spread or "width") of the distribution.
</p>
</div>
</li>
<li>
<a id="sec-3-1-1-3" name="sec-3-1-1-3"></a><code>size</code> : int or tuple of ints, optional<br><div class="outline-text-5" id="text-3-1-1-3">
<p>
Output shape.  If the given shape is, e.g., <code>(m, n, k)</code>, then
<code>m * n * k</code> samples are drawn.  If size is <code>None</code> (default),
a single value is returned if <code>loc</code> and <code>scale</code> are both scalars.
Otherwise, <code>np.broadcast(loc, scale).size</code> samples are drawn.
</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Creating the data</h3>
<div class="outline-text-3" id="text-3-2">
<div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">33500</span><span class="p">,</span><span class="mi">150000</span><span class="p">,</span><span class="mi">3650</span><span class="p">),</span> 
			 <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">41000</span><span class="p">,</span><span class="mi">90000</span><span class="p">,</span><span class="mi">3650</span><span class="p">),</span> 
			 <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">41000</span><span class="p">,</span><span class="mi">120000</span><span class="p">,</span><span class="mi">3650</span><span class="p">),</span> 
			 <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">48000</span><span class="p">,</span><span class="mi">55000</span><span class="p">,</span><span class="mi">3650</span><span class="p">)],</span> 
			<span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1992</span><span class="p">,</span><span class="mi">1993</span><span class="p">,</span><span class="mi">1994</span><span class="p">,</span><span class="mi">1995</span><span class="p">])</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="n">description</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">))</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="right">
<col class="right">
<col class="right">
<col class="right">
</colgroup>
<thead><tr>
<th scope="col" class="left"> </th>
<th scope="col" class="right">1992</th>
<th scope="col" class="right">1993</th>
<th scope="col" class="right">1994</th>
<th scope="col" class="right">1995</th>
</tr></thead>
<tbody>
<tr>
<td class="left">count</td>
<td class="right">3650</td>
<td class="right">3650</td>
<td class="right">3650</td>
<td class="right">3650</td>
</tr>
<tr>
<td class="left">mean</td>
<td class="right">34484.1</td>
<td class="right">39975.7</td>
<td class="right">37565.7</td>
<td class="right">47798.5</td>
</tr>
<tr>
<td class="left">std</td>
<td class="right">150473</td>
<td class="right">88558.5</td>
<td class="right">120317</td>
<td class="right">54828.1</td>
</tr>
<tr>
<td class="left">min</td>
<td class="right">-528303</td>
<td class="right">-287127</td>
<td class="right">-382709</td>
<td class="right">-138895</td>
</tr>
<tr>
<td class="left">25%</td>
<td class="right">-67555.3</td>
<td class="right">-21665.5</td>
<td class="right">-45516.9</td>
<td class="right">11680</td>
</tr>
<tr>
<td class="left">50%</td>
<td class="right">31756.2</td>
<td class="right">41001.8</td>
<td class="right">39197.2</td>
<td class="right">49103.4</td>
</tr>
<tr>
<td class="left">75%</td>
<td class="right">135081</td>
<td class="right">99766.9</td>
<td class="right">121367</td>
<td class="right">84272</td>
</tr>
<tr>
<td class="left">max</td>
<td class="right">622629</td>
<td class="right">358328</td>
<td class="right">423793</td>
<td class="right">262364</td>
</tr>
</tbody>
</table>
<p>
Comparing the sample to the values fed to the <code>normal</code> function it appears that even with 3,650 values, it's still not exactly what we asked for.
</p>

<div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">kde</span><span class="p">()</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>


<div class="figure">
<p><img src="assignment3distributions.png" alt="assignment3distributions.png"></p>
</div>

<p>
1992, the plot with the largest spread looks kind of lumpy. Their means look surprisingly close, but that's probably because the large standaard deviation distorts the scale.
</p>

<div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">()</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>

<p>
<img src="assignment3easyboxplot.png" alt="assignment3easyboxplot.png">
The box-plot shows once again that the centers are relatively close. But 1992 and 1994 have considerably more spread than 1993 and especially more than 1995.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Interval Check</h2>
<div class="outline-text-2" id="text-4">
<p>
This is the class that implements the plotting. It colors the bar-plots based on whether the value given is within a bar's confidence interval (white), below the confidence interval (blue) or above the confidence interval (red).
</p>

<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IntervalCheck</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""colors plot based on whether a value is in range</span>
<span class="sd">    Args:</span>
<span class="sd">     data (DataFrame): frame with data of interest as columns</span>
<span class="sd">     confidence_interval (float): probability we want to exceed</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">confidence_interval</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">confidence_interval</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_intervals</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_lows</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_highs</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_means</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""list of high and low interval tuples"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intervals</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>    
	    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_intervals</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_interval</span><span class="p">,</span>
						   <span class="n">loc</span><span class="o">=</span><span class="n">datum</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
						   <span class="n">scale</span><span class="o">=</span><span class="n">datum</span><span class="o">.</span><span class="n">sem</span><span class="p">())</span>
			       <span class="k">for</span> <span class="n">datum</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intervals</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""the low-ends for the confidence intervals</span>
<span class="sd">	Returns:</span>
<span class="sd">	 numpy.array of low-end confidence interval values</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lows</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_lows</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">low</span> <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">])</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lows</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">highs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""high-ends for the confidence intervals</span>
<span class="sd">	Returns:</span>
<span class="sd">	 numpy.array of high-end values for confidence intervals</span>
<span class="sd">	"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_highs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_highs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">high</span> <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">])</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_highs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">means</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""the means of the data-arrays"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_means</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_means</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_means</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">errors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""The size of the errors, rather than the ci values"""</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
	    <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">highs</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_errors</span>

    <span class="k">def</span> <span class="nf">print_intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""print org-mode formatted table of the confidence intervals"""</span>
	<span class="n">intervals</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">column</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
				      <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)},</span>
				     <span class="n">index</span><span class="o">=</span><span class="s2">"low high"</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
	<span class="k">try</span><span class="p">:</span>
	    <span class="k">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">))</span>
	<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
	    <span class="c1"># not supported</span>
	    <span class="k">pass</span>
	<span class="k">return</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
	<span class="sd">"""plots the data and value</span>
<span class="sd">	* blue bar if value above c.i.</span>
<span class="sd">	* white bar if value in c.i.</span>
<span class="sd">	* red bar if value is below c.i.</span>

<span class="sd">	Args:</span>
<span class="sd">	 value (float): what to compare to the data</span>
<span class="sd">	"""</span>
	<span class="n">figure</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
	<span class="n">axe</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

	<span class="n">x_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
	<span class="n">bars</span> <span class="o">=</span> <span class="n">axe</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span>
	<span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">x_labels</span><span class="p">)</span>
	<span class="n">pyplot</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'darkorange'</span><span class="p">)</span>
	<span class="n">pyplot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
		    <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s2">"facecolor"</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">,</span> <span class="s2">"boxstyle"</span><span class="p">:</span> <span class="s2">"round"</span><span class="p">})</span>
	<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bars</span><span class="p">):</span>
	    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lows</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
		<span class="n">bar</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">'crimson'</span><span class="p">)</span>
	    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">lows</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">highs</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
		<span class="n">bar</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">'w'</span><span class="p">)</span>
		<span class="n">bar</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">)</span>
	    <span class="k">else</span><span class="p">:</span>
		<span class="n">bar</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">)</span>
	<span class="k">return</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Examples</h2>
<div class="outline-text-2" id="text-5">
<p>
First, I'll take a look at the values for the confidence intervals so that I can find values to plot. Here are the confidence intervals for the data I created.
</p>

<div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">IntervalCheck</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">print_intervals</span><span class="p">()</span>
</pre></div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="right">
<col class="right">
<col class="right">
<col class="right">
</colgroup>
<thead><tr>
<th scope="col" class="left"> </th>
<th scope="col" class="right">1992</th>
<th scope="col" class="right">1993</th>
<th scope="col" class="right">1994</th>
<th scope="col" class="right">1995</th>
</tr></thead>
<tbody>
<tr>
<td class="left">low</td>
<td class="right">29602.5</td>
<td class="right">37102.7</td>
<td class="right">33662.4</td>
<td class="right">46019.8</td>
</tr>
<tr>
<td class="left">high</td>
<td class="right">39365.7</td>
<td class="right">42848.6</td>
<td class="right">41469</td>
<td class="right">49577.2</td>
</tr>
</tbody>
</table>
<p>
Here's a value that is below all the confidence intervals.
</p>

<div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">29000</span>
<span class="n">plotter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<div class="figure">
<p><img src="assignment3easybarplot.png" alt="assignment3easybarplot.png"></p>
</div>

<p>
Here's a value that is within 1992's confidence interval but below the other years.
</p>

<div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">33000</span>
<span class="n">plotter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<div class="figure">
<p><img src="assignment3easybarplot2.png" alt="assignment3easybarplot2.png"></p>
</div>

<p>
Here's a value within 1993's and 1994's confidence intervals, but above 1992's and below 1995's confidence intervals.
</p>

<div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">39974</span>
<span class="n">plotter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<div class="figure">
<p><img src="assignment3easybarplot3.png" alt="assignment3easybarplot3.png"></p>
</div>

<p>
Here's a value that is within 1993's confidence interval only.
</p>
<div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">42000</span>
<span class="n">plotter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<div class="figure">
<p><img src="assignment3easybarplot4.png" alt="assignment3easybarplot4.png"></p>
</div>

<p>
Here's a value withing only 1995's confidence interval.
</p>

<div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">49500</span>
<span class="n">plotter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<div class="figure">
<p><img src="assignment3easybarplot5.png" alt="assignment3easybarplot5.png"></p>
</div>

<p>
And finally, a value that's above all the confidence intervals.
</p>
<div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">plotter</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>


<div class="figure">
<p><img src="assignment3easybarplot6.png" alt="assignment3easybarplot6.png"></p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef">
<sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup><p class="footpara">
Wikipedia, "Normal distribution", <a href="http://en.wikipedia.org/wiki/Normal_distribution">http://en.wikipedia.org/wiki/Normal_distribution</a>
</p>
</div>

<div class="footdef">
<sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup><p class="footpara">
P. R. Peebles Jr., "Central Limit Theorem" in "Probability, Random Variables and Random Signal Principles", 4th ed., 2001, pp. 51, 51, 125.
</p>
</div>


</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/python-visualization-coursera/" rel="tag">python visualization coursera</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../assignment-2-olympic-medals/" rel="prev" title="Assignment 2 - Pandas Introduction (Olympic Medals)">Previous post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2017         <a href="mailto:necromuralist@gmail.com">necromuralist</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
